<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Simple GLB + EXR Scene</title>
  <style>
    body { margin: 0; overflow: hidden; }
    /* GUI มุมซ้ายล่าง */
    .dg.ac {
    top: 20px !important;
    left: 20px !important;
    bottom: auto !important;
    right: auto !important;
    background: rgba(255, 255, 255, 0.85) !important; /* สีขาวโปร่ง */
    border-radius: 12px !important; /* ขอบโค้ง */
    padding: 10px !important;
    box-shadow: 0 8px 20px rgba(0,0,0,0.6) !important; /* เงา */
  }

  .dg li {
    font-size: 14px;
    color: #a16060;
  }

  .dg .folder .title {
    font-weight: bold;
    background: #f0c987; /* สีโทนอ่อนน่ารัก */
    border-radius: 8px;
    padding: 4px 8px;
    margin-bottom: 5px;
    color: #222;
    box-shadow: 0 3px 8px rgba(0,0,0.5,0.2);
  }

  .dg .cr .slider {
    background: linear-gradient(90deg, #fcb045) !important;
    border-radius: 6px !important;
  }

  .dg .cr .slider-fg {
    background: #fff !important;
    border-radius: 6px !important;
  }

  .dg .c input[type=number] {
    border-radius: 6px;
    border: 1px solid #ccc;
    padding: 2px 4px;
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/EXRLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dat.gui@0.7.7/build/dat.gui.min.js"></script>
</head>
<body>
<script>
  // ------------------------------
  // Renderer
  // ------------------------------
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.shadowMap.enabled = true;
  renderer.outputEncoding = THREE.sRGBEncoding;
  renderer.toneMapping = THREE.ACESFilmicToneMapping;
  renderer.toneMappingExposure = 1.0;
  document.body.appendChild(renderer.domElement);

  // ------------------------------
  // Scene & Camera
  // ------------------------------
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
  camera.position.set(0, 2, 5);

  const controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;

  // ------------------------------
  // Lights
  // ------------------------------
  const ambient = new THREE.AmbientLight(0xffffff, 0.7);
  scene.add(ambient);

  const directional = new THREE.DirectionalLight(0xffffff, 1.5);
  directional.position.set(5, 8, -2);
  directional.castShadow = true;
  scene.add(directional);

  // ------------------------------
  // GUI สำหรับปรับแสง
  // ------------------------------
  const gui = new dat.GUI({ width: 250 });
  const settings = {
    dirX: directional.position.x,
    dirY: directional.position.y,
    dirZ: directional.position.z,
    intensity: directional.intensity,
    exposure: renderer.toneMappingExposure
  };
  const folder = gui.addFolder("Directional Light");
  folder.add(settings, "dirX", -10, 10).onChange(v => directional.position.x = v);
  folder.add(settings, "dirY", 0, 15).onChange(v => directional.position.y = v);
  folder.add(settings, "dirZ", -10, 10).onChange(v => directional.position.z = v);
  folder.add(settings, "intensity", 0, 5).onChange(v => directional.intensity = v);
  folder.open();
  gui.add(settings, "exposure", 0, 5).onChange(v => renderer.toneMappingExposure = v);

  // ------------------------------
  // Load EXR 360° Background
  // ------------------------------
  const exrLoader = new THREE.EXRLoader();
  exrLoader.load(
    'https://raw.githubusercontent.com/Chiratha/PBR_Shader/main/charolettenbrunn_park_1k.exr',
    texture => {
      texture.mapping = THREE.EquirectangularReflectionMapping;
      scene.environment = texture;
      scene.background = texture;
    }
  );

  // ------------------------------
  // Load GLB model
  // ------------------------------
  const gltfLoader = new THREE.GLTFLoader();
  gltfLoader.load(
    'https://raw.githubusercontent.com/Chiratha/PBR_Shader/main/camera.glb',
    gltf => {
      const model = gltf.scene;
      model.traverse(c => { if(c.isMesh){ c.castShadow = true; c.receiveShadow = true; }});
      scene.add(model);
    },
    undefined,
    err => console.error(err)
  );

  // ------------------------------
  // Floor
  // ------------------------------
  const floorMat = new THREE.MeshStandardMaterial({ color: 0x999999 });
  const floor = new THREE.Mesh(new THREE.PlaneGeometry(50, 50), floorMat);
  floor.rotation.x = -Math.PI/2;
  floor.receiveShadow = true;
  scene.add(floor);

  // ------------------------------
  // Animate
  // ------------------------------
  function animate(){
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  window.addEventListener('resize', ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

</script>
</body>
</html>
